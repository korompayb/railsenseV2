<!DOCTYPE html>
<html lang="hu" data-bs-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RailSense Átkelés-figyelő rendszer</title>
    <meta name="theme-color" content="#1e1e1e">
    <link rel="manifest" href="{{ manifest_url }}" />
    <link rel="icon" href="https://apiv2.phntm.hu/favicon.ico">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/menetrend.css') }}">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

</head>
<style>
    .stops-line::before {
        content: '';
        position: absolute;
        top: 15px;
        left: 11px;
        width: 8px;
        height: 105%;
        z-index: 1;
    }

    .station--end2::before,
    .station--start::before {
        border: 2px solid var(--line-color) !important;
    }

    .arrival-time {
        overflow: hidden;
        white-space: nowrap;
    }

    .highlight {

        font-weight: bold;
    }
</style>


<body>

    <main>
        <div class="container" id="content-container">
            <header class="header sticky-top border-bottom" id="myHeader">

                <div class="row">
                    <div class="col-sm-11">
                        <br>
                        <h1 id="welcome"></h1>

                        <h3
                            class="swipeable-box {% if result_status == 1 %}box-red{% elif result_status == 2 or result_status == 4 %}box-green {% elif result_status == 3 %}box-orange{% endif %}">
                            {% if result_status == 1 %}Az átkelés veszélyes!{% elif result_status == 2 or result_status
                            ==
                            4%}Az átkelés biztonságos!{% elif result_status == 3 %}Kiszolgálóhiba: 500{% endif %} <div
                                class="d-inline-flex gap-2">
                                <a href="{{ url_for('search') }}"
                                    class="btn btn-outline-light ms-3 justify-content-md-end" aria-pressed="false"><svg
                                        xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                        class="bi bi-geo-alt-fill" viewBox="0 0 16 16">
                                        <path
                                            d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10m0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6" />
                                    </svg> Térkép</a><button class="btn btn-outline-light" id="toggle-dark-mode"
                                    data-bs-toggle="button" aria-pressed="false">Mód</button>
                            </div>
                        </h3>

                        <h6 id="date"></h6>
                        <h2
                            class="swipeable-box {% if result_status == 1 %}box-red{% elif result_status == 2 or result_status == 4 %}box-green {% elif result_status == 3 %}box-orange{% endif %}">
                            {{message}}</h2>

                        <!--button class="btn btn-outline-light ms-3" id="dark-mode-toggle" data-bs-toggle="button" aria-pressed="false">Mód</button--><br>

                    </div>

                </div>
            </header>
            <br>
            <div>
                <div>
                    {% for train in trainsdata %}
                    <div class="card" style="max-width: 30rem;">
                        <div style="padding: 0px; overflow: hidden;" class="card-header">
                            <div style="float: left; padding: 13px;">
                                <p id="description" class="card-title text-light description">{{ train.description }}</p>
                                <h4 id="headsign" class="card-subtitle headsign" style="margin-bottom: 0px; margin-top: 5px;">{{
                                    train.headsign }} felé</h4>
                            </div>
                            <div class="viszonylatdoboz d-flex justify-content-center align-items-center"
                                style="float: right; padding: 10px; border-top-right-radius: 5px; background-color:#{{ train.color }} !important; width: 90px; height: 85px;">
                                <span class="shortname" style=" font-weight: bold ;color: #{{ train.text_color }};">{{ train.short_name
                                    }}</span>
                            </div>
                            <script>
                                document.addEventListener('DOMContentLoaded', function () {
                                    function applyMarquee(element) {
                                        if (element.scrollWidth > element.clientWidth) {
                                            var container = document.createElement('div');
                                            container.className = 'marquee-container';
                                            var marquee = document.createElement('div');
                                            marquee.className = 'marquee';
                                            marquee.innerHTML = element.innerHTML;
                                            container.appendChild(marquee);
                                            element.innerHTML = '';
                                            element.appendChild(container);
                                        }
                                    }

                                    var description = document.getElementById('description');
                                    var headsign = document.getElementById('headsign');

                                    applyMarquee(description);
                                    applyMarquee(headsign);
                                });
                            </script>

                        </div>
                        <div class="card-body text-light"
                            style="border-bottom: var(--bs-card-border-width) solid var();">

                            <div class="accordion accordion" id="accordionExample">
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button"
                                            data-bs-toggle="collapse" data-bs-target="#collapse{{ loop.index }}"
                                            aria-expanded="false" aria-controls="collapse{{ loop.index }}"
                                            data-index="{{ loop.index }}">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="26" height="23" viewBox="0 0 26 23" fill="none">
                                                <g clip-path="url(#clip0_122_60)">
                                                <path d="M3.79883 22.9785H21.2109C23.7402 22.9785 25.0195 21.709 25.0195 19.2188V3.78906C25.0195 1.29883 23.7402 0.0292969 21.2109 0.0292969H3.79883C1.2793 0.0292969 0 1.28906 0 3.78906V19.2188C0 21.7188 1.2793 22.9785 3.79883 22.9785ZM3.66211 21.25C2.41211 21.25 1.72852 20.5859 1.72852 19.2969V7.64648C1.72852 6.34766 2.41211 5.69336 3.66211 5.69336H21.3379C22.5781 5.69336 23.2812 6.34766 23.2812 7.64648V19.2969C23.2812 20.5859 22.5781 21.25 21.3379 21.25H3.66211ZM10.0195 10.1855H10.7617C11.1816 10.1855 11.2988 10.0684 11.2988 9.6582V8.92578C11.2988 8.51562 11.1816 8.4082 10.7617 8.4082H10.0195C9.60938 8.4082 9.49219 8.51562 9.49219 8.92578V9.6582C9.49219 10.0684 9.60938 10.1855 10.0195 10.1855ZM14.2676 10.1855H15.0098C15.4199 10.1855 15.5371 10.0684 15.5371 9.6582V8.92578C15.5371 8.51562 15.4199 8.4082 15.0098 8.4082H14.2676C13.8477 8.4082 13.7305 8.51562 13.7305 8.92578V9.6582C13.7305 10.0684 13.8477 10.1855 14.2676 10.1855ZM18.5059 10.1855H19.248C19.6582 10.1855 19.7852 10.0684 19.7852 9.6582V8.92578C19.7852 8.51562 19.6582 8.4082 19.248 8.4082H18.5059C18.0957 8.4082 17.9688 8.51562 17.9688 8.92578V9.6582C17.9688 10.0684 18.0957 10.1855 18.5059 10.1855ZM5.78125 14.3555H6.52344C6.93359 14.3555 7.06055 14.248 7.06055 13.8379V13.0957C7.06055 12.6953 6.93359 12.5781 6.52344 12.5781H5.78125C5.37109 12.5781 5.24414 12.6953 5.24414 13.0957V13.8379C5.24414 14.248 5.37109 14.3555 5.78125 14.3555ZM10.0195 14.3555H10.7617C11.1816 14.3555 11.2988 14.248 11.2988 13.8379V13.0957C11.2988 12.6953 11.1816 12.5781 10.7617 12.5781H10.0195C9.60938 12.5781 9.49219 12.6953 9.49219 13.0957V13.8379C9.49219 14.248 9.60938 14.3555 10.0195 14.3555ZM14.2676 14.3555H15.0098C15.4199 14.3555 15.5371 14.248 15.5371 13.8379V13.0957C15.5371 12.6953 15.4199 12.5781 15.0098 12.5781H14.2676C13.8477 12.5781 13.7305 12.6953 13.7305 13.0957V13.8379C13.7305 14.248 13.8477 14.3555 14.2676 14.3555ZM18.5059 14.3555H19.248C19.6582 14.3555 19.7852 14.248 19.7852 13.8379V13.0957C19.7852 12.6953 19.6582 12.5781 19.248 12.5781H18.5059C18.0957 12.5781 17.9688 12.6953 17.9688 13.0957V13.8379C17.9688 14.248 18.0957 14.3555 18.5059 14.3555ZM5.78125 18.5352H6.52344C6.93359 18.5352 7.06055 18.4277 7.06055 18.0176V17.2754C7.06055 16.8652 6.93359 16.7578 6.52344 16.7578H5.78125C5.37109 16.7578 5.24414 16.8652 5.24414 17.2754V18.0176C5.24414 18.4277 5.37109 18.5352 5.78125 18.5352ZM10.0195 18.5352H10.7617C11.1816 18.5352 11.2988 18.4277 11.2988 18.0176V17.2754C11.2988 16.8652 11.1816 16.7578 10.7617 16.7578H10.0195C9.60938 16.7578 9.49219 16.8652 9.49219 17.2754V18.0176C9.49219 18.4277 9.60938 18.5352 10.0195 18.5352ZM14.2676 18.5352H15.0098C15.4199 18.5352 15.5371 18.4277 15.5371 18.0176V17.2754C15.5371 16.8652 15.4199 16.7578 15.0098 16.7578H14.2676C13.8477 16.7578 13.7305 16.8652 13.7305 17.2754V18.0176C13.7305 18.4277 13.8477 18.5352 14.2676 18.5352Z" fill="#C6C6C6"/>
                                                </g>
                                                <defs>
                                                <clipPath id="clip0_122_60">
                                                <rect width="25.3809" height="22.9785" fill="white"/>
                                                </clipPath>
                                                </defs>
                                                </svg>
                                                <span style="padding-left: 10px !important;">Menetrend</span>
                                            

                                        </button>
                                    </h2>
                                    <div id="collapse{{ loop.index }}" class="accordion-collapse collapse"
                                        data-bs-parent="#accordionExample">
                                        <div class="accordion-body">
                                            <table id="menetrend">

                                                <ul class="line line--m2"
                                                    style="--line-color: #{{train.color}} !important; border-color: var(--line-color);">
                                                    <li class="station station--start">
                                                        <strong class="stop-name">{{ train.trip_details.0.stop_name
                                                            }}</strong>
                                                        <span style="float: inline-end;" class="arrival-time">{{
                                                            train.trip_details.0.arrival_time }}</span>
                                                    </li>
                                                    {% for stop in train.trip_details[1:-1] %}
                                                    <li class="station station--default">
                                                        <span class="stop-name {% if (stop.stopseqe2 == train.stop_sequence) %}
                                                        highlight
                                                        {% endif %}" style="max-width: 19px;">{{ stop.stop_name
                                                            }}</span>
                                                        <small>
                                                        </small>
                                                        <span style="float: inline-end; max-width: 10ch; /* Max 10 karakter szélesség */
                                                        white-space: nowrap;
                                                        overflow: hidden;
                                                        text-overflow: ellipsis;" class="arrival-time">{{
                                                            stop.arrival_time }}</span>
                                                    </li>
                                                    {% endfor %}
                                                    <li class="station station--end2">
                                                        <strong class="stop-name">{{ train.trip_details[-1].stop_name
                                                            }}</strong>
                                                        <span style="float: inline-end;" class="arrival-time">{{
                                                            train.trip_details[-1].arrival_time }}</span>
                                                    </li>
                                                </ul>

                                            </table>

                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="card-footer" style="background-color: var(--primary-color); vertical-align: top;">
                            <div class="rounded"
                                style="padding: 5px; vertical-align: middle; width: fit-content; border: 1px solid;">
                                <div
                                    style="vertical-align: middle; box-sizing: border-box; display: flex; flex-direction: row;">
                                    
                                    <svg class="svgtime"
                                        style="box-sizing: border-box; overflow: scroll; background-color: transparent;"
                                        class="svgdoboz2" width="22" height="22" viewBox="0 0 22 19"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M9.0791 18.7334C10.292 18.7334 11.4697 18.4873 12.5508 18.0303C12.1377 17.582 11.8213 17.0547 11.5928 16.4922C10.8105 16.7822 9.9668 16.9492 9.0791 16.9492C5.03613 16.9492 1.79297 13.6973 1.79297 9.6543C1.79297 5.61133 5.02734 2.36816 9.07031 2.36816C12.7266 2.36816 15.7412 5.04004 16.2686 8.54688C16.8135 8.45898 17.5342 8.48535 18.0879 8.62598C17.5693 4.12598 13.6934 0.575195 9.07031 0.575195C4.0957 0.575195 0 4.68848 0 9.6543C0 14.6289 4.10449 18.7334 9.0791 18.7334ZM4.63184 10.7441H9.07031C9.46582 10.7441 9.76465 10.4365 9.76465 10.0498V4.28418C9.76465 3.89746 9.46582 3.58984 9.07031 3.58984C8.68359 3.58984 8.37598 3.89746 8.37598 4.28418V9.35547H4.63184C4.23633 9.35547 3.9375 9.6543 3.9375 10.0498C3.9375 10.4365 4.23633 10.7441 4.63184 10.7441ZM16.875 18.7773C19.3359 18.7773 21.4014 16.7207 21.4014 14.251C21.4014 11.7725 19.3535 9.7334 16.875 9.7334C14.3965 9.7334 12.3486 11.7725 12.3486 14.251C12.3486 16.7383 14.3965 18.7773 16.875 18.7773ZM16.3477 16.9229C16.1807 16.9229 15.9785 16.8525 15.8467 16.7119L14.1943 14.9014C14.1064 14.8135 14.0449 14.6377 14.0449 14.4883C14.0449 14.1104 14.335 13.8643 14.6689 13.8643C14.8711 13.8643 15.0293 13.9434 15.1436 14.0664L16.3125 15.3496L18.5537 12.2295C18.6768 12.0713 18.8613 11.957 19.0811 11.957C19.4238 11.957 19.7139 12.2295 19.7139 12.5811C19.7139 12.6865 19.6699 12.8271 19.582 12.9414L16.8662 16.6855C16.7607 16.8262 16.5586 16.9229 16.3477 16.9229Z" />
                                    </svg>
                                    <span style="padding-left: 5px !important;"> Érkezik: <b>{{
                                            train.predicted_arrival_time }}</b></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    {% endfor %}











                    <div class="card2 swipeable-box {% if result_status == 1 %}box-red{% elif result_status == 2 or result_status == 4 %}box-green {% elif result_status == 3 %}box-orange{% endif %}"
                        style="max-width: 30rem;">
                        <div style="padding: 0px; overflow: hidden;" class="card-header">
                            <div style="float: left; padding: 13px;">
                                <p class="card-title text-light">Időjárás</p>
                                <h4 class="card-subtitle swipeable-box {% if result_status == 1 %}box-red{% elif result_status == 2 or result_status == 4 %}box-green {% elif result_status == 3 %}box-orange{% endif %}"
                                    style="margin-bottom: 0px;margin-top: 5px;" id="location-name">
                                    {{address}}
                                </h4>
                            </div>
                            <div class="svgdoboz img-fluid swipeable-box {% if result_status == 1 %}box-red{% elif result_status == 2 or result_status == 4 %}box-green {% elif result_status == 3 %}box-orange{% endif %}"
                                style="float: right; padding: 10px; border-top-right-radius: 5px;">
                                <img src="https://openweathermap.org/img/wn/{{ weather_data.icon_code }}@2x.png"
                                    alt="Weather Icon" style="width: 65px; height: 70;"></img>
                            </div>
                        </div>
                        <div class="card-body text-light"
                            style="border-bottom: var(--bs-card-border-width) solid var();">
                            <span id="weather-data">
                                {% if weather_data.temperature >= 0 and weather_data.temperature <= 16 %} <h4
                                    style="color: rgba(0, 0, 255, 0.496)">{{ weather_data.temperature }}&deg;C</h4>
                                    {% elif weather_data.temperature >= 17 and weather_data.temperature <= 30 %} <h4
                                        style="color: #ffa600a3">{{ weather_data.temperature }}&deg;C</h4>
                                        {% elif weather_data.temperature >= 31 %}
                                        <h4 style="color: #ff000068">{{ weather_data.temperature }}&deg;C</h4>
                                        {% endif %}
                            </span>
                            <span id="wind">
                                {% if weather_data.wind_speed >= 0 and weather_data.wind_speed <= 21 %} <h4
                                    style="color: #008000a6">{{ weather_data.wind_speed | round(2) }} km/h</h4>
                                    {% elif weather_data.wind_speed >= 22 and weather_data.wind_speed <= 23 %} <h4
                                        style="color: #ffa600a3">{{ weather_data.wind_speed | round(2) }} km/h</h4>
                                        {% elif weather_data.wind_speed >= 24 %}
                                        <h4 style="color: #ff00008b">{{ weather_data.wind_speed | round(2) }} km/h</h4>
                                        {% endif %}
                            </span>
                            <p>{{ weather_data.description }}</p>
                        </div>
                        <div class="card-footer" style="background-color: var(--primary-color); vertical-align: top;">
                            <div class="rounded"
                                style="padding: 5px; vertical-align: middle; width: fit-content; border: 1px solid;">
                                <div
                                    style="vertical-align: middle; box-sizing: border-box; display: flex; flex-direction: row;">
                                    <svg class="svgtime"
                                        style="box-sizing: border-box; overflow: scroll; background-color: transparent;"
                                        class="svgdoboz2" width="22" height="22" viewBox="0 0 22 19"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M9.0791 18.7334C10.292 18.7334 11.4697 18.4873 12.5508 18.0303C12.1377 17.582 11.8213 17.0547 11.5928 16.4922C10.8105 16.7822 9.9668 16.9492 9.0791 16.9492C5.03613 16.9492 1.79297 13.6973 1.79297 9.6543C1.79297 5.61133 5.02734 2.36816 9.07031 2.36816C12.7266 2.36816 15.7412 5.04004 16.2686 8.54688C16.8135 8.45898 17.5342 8.48535 18.0879 8.62598C17.5693 4.12598 13.6934 0.575195 9.07031 0.575195C4.0957 0.575195 0 4.68848 0 9.6543C0 14.6289 4.10449 18.7334 9.0791 18.7334ZM4.63184 10.7441H9.07031C9.46582 10.7441 9.76465 10.4365 9.76465 10.0498V4.28418C9.76465 3.89746 9.46582 3.58984 9.07031 3.58984C8.68359 3.58984 8.37598 3.89746 8.37598 4.28418V9.35547H4.63184C4.23633 9.35547 3.9375 9.6543 3.9375 10.0498C3.9375 10.4365 4.23633 10.7441 4.63184 10.7441ZM16.875 18.7773C19.3359 18.7773 21.4014 16.7207 21.4014 14.251C21.4014 11.7725 19.3535 9.7334 16.875 9.7334C14.3965 9.7334 12.3486 11.7725 12.3486 14.251C12.3486 16.7383 14.3965 18.7773 16.875 18.7773ZM16.3477 16.9229C16.1807 16.9229 15.9785 16.8525 15.8467 16.7119L14.1943 14.9014C14.1064 14.8135 14.0449 14.6377 14.0449 14.4883C14.0449 14.1104 14.335 13.8643 14.6689 13.8643C14.8711 13.8643 15.0293 13.9434 15.1436 14.0664L16.3125 15.3496L18.5537 12.2295C18.6768 12.0713 18.8613 11.957 19.0811 11.957C19.4238 11.957 19.7139 12.2295 19.7139 12.5811C19.7139 12.6865 19.6699 12.8271 19.582 12.9414L16.8662 16.6855C16.7607 16.8262 16.5586 16.9229 16.3477 16.9229Z" />
                                    </svg>
                                    <span id="update_time" style="padding-left: 5px !important;"> Most frissült</span>
                                    <script>document.addEventListener('DOMContentLoaded', function () {
                                            var lastUpdateTime = new Date();
                                            var dateElement = document.getElementById('update_time');

                                            function updateDateDisplay() {
                                                var now = new Date();
                                                var diffInMinutes = Math.floor((now - lastUpdateTime) / 60000); // Convert milliseconds to minutes

                                                var displayText;
                                                if (diffInMinutes === 0) {
                                                    displayText = 'Most frissítve';
                                                } else if (diffInMinutes === 1) {
                                                    displayText = '1 perce frissítve';
                                                } else {
                                                    displayText = diffInMinutes + ' perce frissítve';
                                                }
                                                dateElement.textContent = displayText;

                                                if (diffInMinutes > 0) {
                                                    highlight();
                                                }
                                            }

                                            function highlight() {
                                                dateElement.classList.add('highlight');
                                                setTimeout(function () {
                                                    dateElement.classList.remove('highlight');
                                                }, 2000);
                                            }

                                            function refreshData() {
                                                // Simulate an AJAX call with setTimeout
                                                setTimeout(function () {
                                                    // Update the last update time
                                                    lastUpdateTime = new Date();

                                                    // Immediately update the display
                                                    updateDateDisplay();
                                                }, 1000); // Simulate 1 second delay for AJAX
                                            }

                                            // Update the date display every minute
                                            setInterval(updateDateDisplay, 60000);

                                            // Simulate an initial data refresh
                                            refreshData();

                                            // Simulate subsequent data refreshes every 60 seconds
                                            setInterval(refreshData, 60000);
                                        });
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br>

    </main>


    <script>
        function truncateText() {
            var maxChars;
            if (window.innerWidth <= 320) {
                maxChars = 10;
            } else if (window.innerWidth <= 768) {
                maxChars = 18;
            } else {
                maxChars = 30;
            }

            var stopNames = document.querySelectorAll('.stop-name');
            stopNames.forEach(function (stopName) {
                var text = stopName.textContent;
                if (text.length > maxChars) {
                    stopName.textContent = text.slice(0, maxChars) + '...';
                }
            });
        }

        function refreshData() {
            // AJAX kérés futtatása, adatok frissítése

            // Miután az adatok frissültek, újra alkalmazzuk a szöveg levágását
            truncateText();
        }

        document.addEventListener('DOMContentLoaded', function () {
            // Oldal betöltésekor alkalmazzuk a szöveg levágását
            truncateText();

            // Re-apply truncation on window resize
            window.addEventListener('resize', truncateText);

            // AJAX frissítés esetén
            // refreshData függvény meghívása
        });
    </script>
    <script>window.onscroll = function () { myFunction() };

        var header = document.getElementById("myHeader");
        var sticky = header.offsetTop;

        function myFunction() {
            if (window.pageYOffset > sticky) {
                header.classList.add("sticky");
            } else {
                header.classList.remove("sticky");
            }
        }</script>

    <script>
        /* global bootstrap: false */
        (function () {
            'use strict'
            var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
            tooltipTriggerList.forEach(function (tooltipTriggerEl) {
                new bootstrap.Tooltip(tooltipTriggerEl)
            })
        })()


        // Amikor az akkordion elem megnyílik
        $(".accordion-button").on("click", function () {
            var index = $(this).data("index");
            localStorage.setItem("activeAccordionIndex", index);
        });

        // Az oldal betöltődésekor
        $(document).ready(function () {
            var activeIndex = localStorage.getItem("activeAccordionIndex");
            if (activeIndex !== null) {
                $("#collapse" + activeIndex).collapse("show");
            }
        });

    </script>





    <script>

        const openButton = document.querySelector("[data-open-modal]")
        const closeButton = document.querySelector("[data-close-modal]")
        const modal = document.querySelector("[data-modal]")

        openButton.addEventListener("click", () => {
            modal.showModal()
        })


    </script>


    <script>
        // Az oldal betöltése után végrehajtandó kód
        document.addEventListener("DOMContentLoaded", function () {
            // Az idő és a köszöntés beállítása
            updateDateTime();

            // Az idő és a köszöntés frissítése minden másodpercben
            setInterval(updateDateTime, 3000);

            // AJAX kérés indítása 10 másodpercenként
            setInterval(function () {
                // XMLHttpRequest objektum létrehozása
                var xhr = new XMLHttpRequest();

                // AJAX kérés konfigurálása
                xhr.open('GET', '/railsense', true);

                // AJAX kérés sikerességének kezelése
                xhr.onload = function () {
                    // Ellenőrizzük a válasz státuszát
                    if (xhr.status >= 200 && xhr.status < 300) {
                        // A válasz feldolgozása
                        var response = xhr.responseText;

                        // A konténer elem tartalmának frissítése
                        document.getElementById('content-container').innerHTML = response;
                    } else {
                        // Hibakezelés, ha a szerver hibát ad vissza
                        console.error('Hiba történt az AJAX kérés során: ' + xhr.status);
                    }
                };

                // Hibakezelés a hálózati problémák esetén
                xhr.onerror = function () {
                    console.error('Hálózati hiba történt az AJAX kérés során.');
                };

                // AJAX kérés küldése
                xhr.send();
            }, 30000); // 10 másodpercenkénti frissítés
        });

        // Az idő és a köszöntés frissítése
        function updateDateTime() {
            // Jelenlegi dátum és idő lekérdezése
            var currentDate = new Date();
            var options = { year: 'numeric', month: 'short', day: 'numeric', hour: 'numeric', minute: 'numeric' };
            var formattedDate = currentDate.toLocaleDateString('hu-HU', options);

            // datum kiiras
            var dateElement = document.getElementById('date');
            dateElement.innerHTML = formattedDate;

            // udvozlo uzenet az idotol fuggoen
            var welcomeElement = document.getElementById('welcome');
            var currentHour = currentDate.getHours();
            var welcomeMessage = '';

            // Idő és dátum megjelenítése az oldalon
            document.getElementById('date').innerText = formattedDate;
            document.getElementById('welcome').innerText = getWelcomeMessage(currentDate.getHours());
        }

        // Köszöntés üzenet kiválasztása az aktuális órától függően
        function getWelcomeMessage(currentHour) {
            if (currentHour >= 5 && currentHour < 12) {
                return 'Jó reggelt!';
            } else if (currentHour >= 12 && currentHour < 18) {
                return 'Szép napot!';
            } else {
                return 'Jó estét!';
            }
        }
    </script>





    <script src="/service-worker.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const toggleDarkModeButton = document.getElementById('toggle-dark-mode');

            // Ellenőrizzük, hogy van-e mentett dark mode állapot a localStorage-ban
            const isDarkMode = localStorage.getItem('darkMode') === 'enabled';

            // Alkalmazzuk a dark mode-ot, ha be van kapcsolva
            if (isDarkMode) {
                enableDarkMode();
            }

            // Gomb eseménykezelője
            if (toggleDarkModeButton) {
                toggleDarkModeButton.addEventListener('click', () => {
                    const isDarkMode = localStorage.getItem('darkMode') === 'enabled';
                    if (isDarkMode) {
                        disableDarkMode();
                    } else {
                        enableDarkMode();
                    }
                });
            }

            // Dark mode engedélyezése
            function enableDarkMode() {
                addDarkModeClass(document.body);
                localStorage.setItem('darkMode', 'enabled');
                applyDarkModeToAjaxContent(); // Alkalmazza a dark mode-ot az AJAX tartalomra is
                setBootstrapTheme('light');
            }

            // Dark mode letiltása
            function disableDarkMode() {
                removeDarkModeClass(document.body);
                localStorage.setItem('darkMode', 'disabled');
                applyDarkModeToAjaxContent(); // Alkalmazza a dark mode-ot az AJAX tartalomra is
                setBootstrapTheme('dark');
            }

            // Dark mode osztály hozzáadása egy elemhez és annak összes gyermekéhez
            function addDarkModeClass(element) {
                element.classList.add('dark-mode');
                element.querySelectorAll('*').forEach(child => {
                    child.classList.add('dark-mode');
                });
            }

            // Dark mode osztály eltávolítása egy elemből és annak összes gyermekéből
            function removeDarkModeClass(element) {
                element.classList.remove('dark-mode');
                element.querySelectorAll('*').forEach(child => {
                    child.classList.remove('dark-mode');
                });
            }

            // Bootstrap témaváltás beállítása
            function setBootstrapTheme(theme) {
                const root = document.querySelector(':root');
                root.setAttribute('data-bs-theme', theme); // Az új Bootstrap 5 változatban a data-bs-theme helyett data-theme használata
            }

            // Dark mode alkalmazása az AJAX-szal betöltött tartalomra
            function applyDarkModeToAjaxContent() {
                const ajaxContentElements = document.querySelectorAll('.ajax-content');
                ajaxContentElements.forEach(element => {
                    const isDarkMode = localStorage.getItem('darkMode') === 'enabled';
                    if (isDarkMode) {
                        addDarkModeClass(element);
                        setBootstrapTheme('dark'); // Bootstrap témaváltás dark mode-ra
                    } else {
                        removeDarkModeClass(element);
                        setBootstrapTheme('light'); // Bootstrap témaváltás light mode-ra
                    }

                    // SVG elemek kezelése dark mode esetén
                    const svgElements = element.querySelectorAll('svg');
                    svgElements.forEach(svg => {
                        if (isDarkMode) {
                            svg.classList.add('dark-mode');
                        } else {
                            svg.classList.remove('dark-mode');
                        }
                    });
                });
            }

            // AJAX frissítések kezelése
            document.addEventListener('ajaxComplete', () => {
                applyDarkModeToAjaxContent();
            });

            // Alkalmazza a dark mode-ot az oldal betöltéskor és AJAX után
            applyDarkModeToAjaxContent();

            // Szöveg levágása a megadott méret alapján
            function truncateText() {
                let maxChars;
                if (window.innerWidth <= 320) {
                    maxChars = 10;
                } else if (window.innerWidth <= 768) {
                    maxChars = 18;
                } else {
                    maxChars = 30;
                }

                const stopNames = document.querySelectorAll('.stop-name');
                stopNames.forEach(stopName => {
                    const text = stopName.textContent;
                    if (text.length > maxChars) {
                        stopName.textContent = text.slice(0, maxChars) + '...';
                    }
                });
            }

            // Oldal betöltésekor alkalmazzuk a szöveg levágást
            document.addEventListener('DOMContentLoaded', function () {
                truncateText();
            });

            // Szöveg levágás újra alkalmazása ablak átméretezésekor
            window.addEventListener('resize', truncateText);

            // AJAX frissítés után is alkalmazzuk a szöveg levágást
            document.addEventListener('ajaxComplete', truncateText);

            // Dátum frissítése és kiírása
            let lastUpdateTime = new Date();
            const dateElement = document.getElementById('update_time');

            function updateDateDisplay() {
                const now = new Date();
                const diffInMinutes = Math.floor((now - lastUpdateTime) / 60000); // Perc alapú különbség

                let displayText;
                if (diffInMinutes === 0) {
                    displayText = 'Most frissítve';
                } else if (diffInMinutes === 1) {
                    displayText = '1 perce frissítve';
                } else {
                    displayText = diffInMinutes + ' perce frissítve';
                }
                dateElement.textContent = displayText;

                if (diffInMinutes > 0) {
                    highlight();
                }
            }

            function highlight() {
                dateElement.classList.add('highlight');
                setTimeout(() => {
                    dateElement.classList.remove('highlight');
                }, 2000);
            }

            // Dátum frissítése minden percenként
            setInterval(updateDateDisplay, 60000);

            // AJAX-szimuláció frissítése
            function refreshData() {
                setTimeout(() => {
                    lastUpdateTime = new Date();
                    updateDateDisplay();
                }, 1000); // 1 másodperc késleltetés AJAX-hoz
            }

            refreshData();
            setInterval(refreshData, 60000); // 60 másodpercenkénti AJAX frissítés

            // Scrollra rögzített elem kezelése
            window.onscroll = function () {
                const header = document.getElementById('myHeader');
                const sticky = header.offsetTop;
                if (window.pageYOffset > sticky) {
                    header.classList.add('sticky');
                } else {
                    header.classList.remove('sticky');
                }
            };

            // Bootstrap tooltip inicializálása
            document.addEventListener('DOMContentLoaded', function () {
                const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
                tooltipTriggerList.forEach(tooltipTriggerEl => {
                    new bootstrap.Tooltip(tooltipTriggerEl);
                });
            });

            // Akkordion indexének mentése
            $('.accordion-button').on('click', function () {
                const index = $(this).data('index');
                localStorage.setItem('activeAccordionIndex', index);
            });

            // Oldal betöltésekor az akkordion megnyitása
            $(document).ready(function () {
                const activeIndex = localStorage.getItem('activeAccordionIndex');
                if (activeIndex !== null) {
                    $('#collapse' + activeIndex).collapse('show');
                }
            });

            // Service worker regisztráció
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', function () {
                    navigator.serviceWorker.register('/service-worker.js')
                        .then(function (registration) {
                            console.log('Service Worker registered with scope:', registration.scope);
                        })
                        .catch(function (error) {
                            console.error('Service Worker registration failed:', error);
                        });
                });
            }

            // Idő és köszöntés frissítése
            function updateDateTime() {
                const currentDate = new Date();
                const options = { year: 'numeric', month: 'short', day: 'numeric', hour: 'numeric', minute: 'numeric' };
                const formattedDate = currentDate.toLocaleDateString('hu-HU', options);

                document.getElementById('date').innerText = formattedDate;
                document.getElementById('welcome').innerText = getWelcomeMessage(currentDate.getHours());
            }

            // Köszöntő üzenet kiválasztása az időtől függően
            function getWelcomeMessage(currentHour) {
                if (currentHour >= 5 && currentHour < 12) {
                    return 'Jó reggelt!';
                } else if (currentHour >= 12 && currentHour < 18) {
                    return 'Szép napot!';
                } else {
                    return 'Jó estét!';
                }
            }

            // Idő és köszöntés frissítése minden 3 másodpercben
            setInterval(updateDateTime, 3000);

            // Swipeable box kezelése
            const swipeableBox = document.getElementById('swipeable-box');
            swipeableBox.addEventListener('click', function () {
                swipeableBox.classList.toggle('expanded');
            });

        });

    </script>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>



</body>

</html>